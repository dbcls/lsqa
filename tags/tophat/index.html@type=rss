<?xml version="1.0" encoding="utf-8"?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>Questions Tagged With tophat</title><link>http://qa.lifesciencedb.jp/tags/tophat/&amp;type=rss</link><description>questions tagged &lt;span class="tag"&gt;tophat&lt;/span&gt;</description><atom:link href="http://qa.lifesciencedb.jp/tags/tophat/" rel="self"></atom:link><language>ja</language><lastBuildDate>Thu, 19 Jul 2018 15:29:31 +0900</lastBuildDate><item><title>Tophatとcufflinksがインストールできない</title><link>http://qa.lifesciencedb.jp/questions/880/tophat%E3%81%A8cufflinks%E3%81%8C%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84</link><description>&lt;p&gt;こんにちは&lt;/p&gt;
&lt;p&gt;Tophatとcufflinksがインストールできません。
レベルは初心者なので、わけもわからずやっている状態ですが、
DRY解析教本を読みながらコツコツやっています。
いろいろやってみましたが、どうにもなりませんでした。&lt;/p&gt;
&lt;p&gt;$brew install tophat
    Error: No available formula with the name "tophat" 
    ==&amp;gt; Searching for a previously deleted formula (in the last month)...
    Error: No previously deleted formula found.
    ==&amp;gt; Searching for similarly named formulae...
    Error: No similarly named formulae found.
    ==&amp;gt; Searching taps...
    ==&amp;gt; Searching taps on GitHub...
    Error: No formulae found in taps.&lt;/p&gt;
&lt;p&gt;$ brew install cufflinks
Error: No available formula with the name "cufflinks" 
==&amp;gt; Searching for a previously deleted formula (in the last month)...
Error: No previously deleted formula found.
==&amp;gt; Searching for similarly named formulae...
Error: No similarly named formulae found.
==&amp;gt; Searching taps...
==&amp;gt; Searching taps on GitHub...
Error: No formulae found in taps.&lt;/p&gt;
&lt;p&gt;$brew tap brewsci/science
    ==&amp;gt; Tapping brewsci/science
    Cloning into '/usr/local/Homebrew/Library/Taps/brewsci/homebrew-science'...
    remote: Counting objects: 468, done.
    remote: Compressing objects: 100% (465/465), done.
    remote: Total 468 (delta 1), reused 153 (delta 1), pack-reused 0
    Receiving objects: 100% (468/468), 429.98 KiB | 305.00 KiB/s, done.
    Resolving deltas: 100% (1/1), done.
    Error: Invalid formula: /usr/local/Homebrew/Library/Taps/brewsci/homebrew-science/Formula/ome-common.rb
    uninitialized constant #&amp;lt;class:0x00000001032840c0&amp;gt;::MinimumMacOSRequirement
    Did you mean?  MaximumMacOSRequirement
    Error: Invalid formula: /usr/local/Homebrew/Library/Taps/brewsci/homebrew-science/Formula/ome-files.rb
    uninitialized constant #&amp;lt;class:0x00000001023892a0&amp;gt;::MinimumMacOSRequirement
    Did you mean?  MaximumMacOSRequirement
    Error: Invalid formula: /usr/local/Homebrew/Library/Taps/brewsci/homebrew-science/Formula/ome-xml.rb
    uninitialized constant #&amp;lt;class:0x00000001022e3a08&amp;gt;::MinimumMacOSRequirement
    Did you mean?  MaximumMacOSRequirement
    Error: Invalid formula: /usr/local/Homebrew/Library/Taps/brewsci/homebrew-science/Formula/osgearth.rb
    uninitialized constant #&amp;lt;class:0x0000000103086fe8&amp;gt;::MinimumMacOSRequirement
    Did you mean?  MaximumMacOSRequirement
    Error: Cannot tap brewsci/science: invalid syntax in tap!&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ brew config
HOMEBREW_VERSION: 1.7.0
ORIGIN: https://github.com/Homebrew/brew
HEAD: 7e8fb9a0f8ab5e841763ec6c7fefa72a8462b594
Last commit: 3 days ago
Core tap ORIGIN: https://github.com/Homebrew/homebrew-core
Core tap HEAD: ea3fec61c268ccbbe4172a2f1cbfd08760025cf0
Core tap last commit: 51 minutes ago
HOMEBREW_PREFIX: /usr/local
CPU: quad-core 64-bit skylake
Homebrew Ruby: 2.3.7 =&amp;gt; /usr/local/Homebrew/Library/Homebrew/vendor/portable-ruby/2.3.7/bin/ruby
Clang: 9.1 build 902
Git: 2.18.0 =&amp;gt; /usr/local/bin/git
Curl: 7.54.0 =&amp;gt; /usr/bin/curl
Java: 10.0.2, 1.8.0_121
macOS: 10.13.6-x86_64
CLT: 9.4.1.0.1.1528165917
Xcode: 9.4.1
XQuartz: 2.7.11 =&amp;gt; /opt/X11

$ brew list
bam     eigen       ilmbase     numpy       samtools
bedtools    fastqc      jpeg        opencv      sqlite
blast       ffmpeg      lame        openexr     stringtie
boost       gdbm        libidn2     openssl     tbb
bowtie      gettext     libpng      python      wget
bowtie2     git     libtiff     python@2    x264
bwa     hisat2      libunistring    readline    xvid
curl        htslib      lmdb        rmtrash     xz
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;brewのupdate, upgrade, doctorはしました。問題なかったです。
問題を解決するにあたって何を質問したら良いかもわかっていない状態です。&lt;/p&gt;
&lt;p&gt;どうぞよろしくお願いします。&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">mikan03</dc:creator><pubDate>Thu, 19 Jul 2018 15:29:31 +0900</pubDate><guid>http://qa.lifesciencedb.jp/questions/880/tophat%E3%81%A8cufflinks%E3%81%8C%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84</guid><category>brew</category><category>tophat</category></item><item><title>tophatのエラーについて</title><link>http://qa.lifesciencedb.jp/questions/872/tophat%E3%81%AE%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6</link><description>&lt;p&gt;dry解析教本という本で自習中の初心者です。大学のMacでは出来たのに家のMacMiniだとエラーが出て、理由が分かりません。&lt;/p&gt;
&lt;p&gt;SKMac-mini:expression SK$ tophat -p 1 -G Homo_sapiens/NCBI/build37.2/Annotation/Archives/archive-2014-06-02-13-47-29/Genes/genes.gtf -o tophat_results/ERR266337_P5 Homo_sapiens/NCBI/build37.2/Sequence/Bowtie2Index/genome ERR266337_trim.fastq&lt;/p&gt;
&lt;h2&gt;[2017-10-31 21:32:10] Beginning TopHat run (v2.1.1)&lt;/h2&gt;
&lt;p&gt;[2017-10-31 21:32:10] Checking for Bowtie
          Bowtie version:    2.3.3.1
[2017-10-31 21:32:10] Checking for Bowtie index files (genome)..
[2017-10-31 21:32:10] Checking for reference FASTA file
[2017-10-31 21:32:10] Generating SAM header for Homo_sapiens/NCBI/build37.2/Sequence/Bowtie2Index/genome
Traceback (most recent call last):
  File "/usr/local/bin/tophat", line 4107, in &amp;lt;module&amp;gt;
    sys.exit(main())
  File "/usr/local/bin/tophat", line 3961, in main
    params.read_params = check_reads_format(params, reads_list)
  File "/usr/local/bin/tophat", line 1856, in check_reads_format
    zf = ZReader(f_name, params)
  File "/usr/local/bin/tophat", line 1809, in &lt;strong&gt;init&lt;/strong&gt;
    self.file=open(filename)
IOError: [Errno 2] No such file or directory: 'ERR266337_trim.fastq'&lt;/p&gt;
&lt;p&gt;ところが今いるexpressionというディレクトリには確かにERR266337_trim.fastqが存在するはずだと思います。&lt;/p&gt;
&lt;p&gt;SKMac-mini:expression SK$ ls
ERR266335.fastq             ERR266347.fastq             ERR266351_trim.fastq　
ERR266335_trim.fastq　           ERR266347.fastq.gz          FastQC
ERR266337.fastq             ERR266347_trim.fastq　           Homo_sapiens
ERR266337_trim.fastq　           ERR266349.fastq             Homo_sapiens_NCBI_build37.2.tar.gz
ERR266338.fastq             ERR266349_trim.fastq　           tophat_results
ERR266338_trim.fastq　           ERR266351.fastq&lt;/p&gt;
&lt;p&gt;このエラーはどうして出てきたのでしょう？ご助言がいただければ幸いです。&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">SK</dc:creator><pubDate>Tue, 31 Oct 2017 21:59:50 +0900</pubDate><guid>http://qa.lifesciencedb.jp/questions/872/tophat%E3%81%AE%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6</guid><category>tophat</category></item><item><title>TopHatのreferenceデータについて</title><link>http://qa.lifesciencedb.jp/questions/824/tophat%E3%81%AEreference%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6</link><description>&lt;p&gt;今回はTophat2 (bowtie2)に使用するgenome indexについて質問があり利用させていただきました。&lt;/p&gt;
&lt;p&gt;現在TopHat2およびCufflinksを用いたNGSデータ解析を計画しています。&lt;br&gt;
他のツールの出力と比較する為、annotation及びindexデータは"Ensembl release 72"を使用したいと考えています。&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
Q1) そこで質問ですが、旧バージョンのannotation及びgenome indexをiGenome等でDLすることは可能でしょうか？&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
不可能であればEnsembl archiveのFTPサイトよりDLし、bowtie2でbuildしようかとも考えています。&lt;br&gt;
annotationデータは、FTP内のGTFファイルを、indexデータはDNAのFASTAファイルをbuildして用いようと考えます。&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
Q2) そこでさらに質問ですが、indexデータのbuildに当たり、全ゲノムのfaファイルは存在しないのでしょうか。&lt;/p&gt;
&lt;p&gt;&lt;br&gt;
今回の目的は全ゲノムを対象とするのですが、FTPサイトを見た所、各染色体別のfaファイルしか準備されていません。&lt;br&gt;
これらを必要数つなぎ合わせてgenome indexを作成しても良いものでしょうか。&lt;/p&gt;
&lt;p&gt;基本的な質問となり申し訳ありません。どちらか片方でもお答えくだされば幸いです。&lt;br&gt;
どうぞよろしくお願い致します。&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Kent_allow</dc:creator><pubDate>Tue, 09 Dec 2014 23:48:24 +0900</pubDate><guid>http://qa.lifesciencedb.jp/questions/824/tophat%E3%81%AEreference%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6</guid><category>tophat</category><category>fasta</category><category>reference</category><category>ngs</category></item><item><title>リード長の長いRNA-Seqのタグカウント</title><link>http://qa.lifesciencedb.jp/questions/581/%E3%83%AA%E3%83%BC%E3%83%89%E9%95%B7%E3%81%AE%E9%95%B7%E3%81%84rna-seq%E3%81%AE%E3%82%BF%E3%82%B0%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88</link><description>&lt;p&gt;もしかしたら、常識かもしれないので、
情報お持ちのかたがおられたら、お願いします。&lt;/p&gt;
&lt;p&gt;topHatやmapSpliceなど、splicingを考慮したマッパーの結果から、
遺伝子レベルのタグカウントを計算するうまいやり方など、
情報お持ちのかたがおられましたら、
お知らせいただけますと助かります。&lt;/p&gt;
&lt;h2&gt;以下背景&lt;/h2&gt;
&lt;p&gt;topHat-cufflinks-cuffdiffや、それに類似のフローが
デファクトスタンダード的解析であると知りつつ、
リード長の長いRNA-SeqにedgeR等をかけるやりかたを考えています。&lt;/p&gt;
&lt;p&gt;edgeRなどのDEG検出用のRパッケージ等は、
fpkm/rpkmは使わないように推奨しているかと思います。&lt;/p&gt;
&lt;p&gt;EdgeRのedgeRUsersGuide.pdfより引用
http://www.bioconductor.org/packages/release/bioc/vignettes/edgeR/inst/doc/edgeRUsersGuide.pdf
"There are good reasons
why the NB model is appropriate for the raw count data, but transforming the data using
RPKM (or FPKM or similar) renders our distributional assumptions invalid and we cannot
guarantee that our methods will be reliable for such transformed data."&lt;/p&gt;
&lt;p&gt;35塩基や、50塩基程度であれば、
BWAやBowtieなどで、splicingを考慮せずに、
マップしたものを、
DEGseqパッケージ中のgetGeneExpや、
BEDtoolsのcoverageBEDなどで、タグカウントすればよかったのですが、
最近リード長が伸び、150塩基のRNA-Seqなども
よく見かけるようになったかと思います。
リード長が伸びるとexon長を超えてしまう場合も
多々あるので、junctionをまたぐタグの数を無視するには、
支障が出てきているように思います。&lt;/p&gt;
&lt;p&gt;topHatが出力するaccepted_hits.bamに対して、&lt;/p&gt;
&lt;h3&gt;選択肢1&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Step1 BEDtoolsのbamToBedに"-bed12"オプション付でかけBAMをBEDに変換&lt;/li&gt;
&lt;li&gt;Step2 BEDを入力とするDEGseqのgetGeneExpでタグカウント&lt;/li&gt;
&lt;li&gt;アノテーション情報は、refFlat.txt&lt;/li&gt;
&lt;li&gt;=&amp;gt; イントロン領域のタグは計上されない。&lt;/li&gt;
&lt;li&gt;=&amp;gt; splicing-junctionをまたぐタグがタグカウントに計上されないため、難あり。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;選択肢2&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Step1 coverageBEDに対して、"-abam"でBAM入力で"-splice"オプションを付けて実行。&lt;/li&gt;
&lt;li&gt;アノテーション情報はrefFlat.bed&lt;/li&gt;
&lt;li&gt;=&amp;gt; splicing-junctionをまたぐタグはタグカウントに計上されるので良し。&lt;/li&gt;
&lt;li&gt;=&amp;gt; イントロン領域のタグ(第一イントロンの制御ノンコーディングRNAなど)もカウントされるので難あり。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;一応、BioStarやSeqAnswersで上記難点の解決策も探しては見たのですが、
自分では見つけられませんでした。&lt;/p&gt;
&lt;p&gt;coverageBEDで、イントロンも含めてカウントした後に、
全イントロンのタグ数を引くとか、&lt;/p&gt;
&lt;p&gt;小賢しい手も考えられますが、
境界のリードなどの扱いで、厳密では無くなる点に難があります。&lt;/p&gt;
&lt;p&gt;もし、うまい手やら、既存のスクリプトでこんなものがある等、
関係する情報お知らせいただけますと幸いです。
直接の解答でなくとも、ご助言ありましたら、お願いします。&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">nob_fj</dc:creator><pubDate>Tue, 03 Apr 2012 16:59:13 +0900</pubDate><guid>http://qa.lifesciencedb.jp/questions/581/%E3%83%AA%E3%83%BC%E3%83%89%E9%95%B7%E3%81%AE%E9%95%B7%E3%81%84rna-seq%E3%81%AE%E3%82%BF%E3%82%B0%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88</guid><category>tophat</category><category>ngs</category><category>rna-seq</category><category>long</category><category>splicing-junction</category></item><item><title>Tophatのbutterflyオプションについて</title><link>http://qa.lifesciencedb.jp/questions/536/tophat%E3%81%AEbutterfly%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6</link><description>&lt;p&gt;36bpのシングルエンドRNA-seqデータを使って解析をしようとしているのですが、
バージョン1.0.12から追加された--butterfly-searchというオプションを使ったことの
ある方、または使った時と使わなかった時の比較をされた方はいらっしゃいませんでしょうか？
36bpなので--segment-length 18でジャンクション同定してもノイズが多くなりそうで、
そのままbowtieでマッピングしてしまおうと考えていたのですが、Tophatのマニュアルを
見ていて、このオプションがあることを知ってどうしようか迷っています。
Tophatの論文にはこのbutterflyのアルゴリズムに関する記述はなく、&lt;a href="http://seqanswers.com/forums/showthread.php?t=7254"&gt;SEQanswersでは
数百GBものoutputを出すとの報告があり&lt;/a&gt;
、ラボに大型サーバーがない私では自分で
このオプションをテストするのが難しい状況です。
もしお試しになった方がいらっしゃれば、ご教授お願いいたします。&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Tanakky</dc:creator><pubDate>Fri, 18 Nov 2011 23:07:36 +0900</pubDate><guid>http://qa.lifesciencedb.jp/questions/536/tophat%E3%81%AEbutterfly%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6</guid><category>butterfly</category><category>tophat</category><category>rna-seq</category><category>ngs</category></item><item><title>strand specific RNA-Seqデータ解析におけるtophatの利用について</title><link>http://qa.lifesciencedb.jp/questions/432/strand-specific-rna-seq%E3%83%87%E3%83%BC%E3%82%BF%E8%A7%A3%E6%9E%90%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8Btophat%E3%81%AE%E5%88%A9%E7%94%A8%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6</link><description>&lt;p&gt;strand specific RNA-Seqデータ解析におけるtophatの利用について質問させてください。
現在SOLiD™ Whole Transcriptome Analysis Kitで得られたstrand specific RNA-Seqのデータを解析しております。&lt;/p&gt;
&lt;p&gt;tophatとcufflinksを用いて発現量について観ようとしているのですが、
tophatのlibrary-typeをtophatのマニュアル通りに
&lt;code&gt;--library-type fr-secondstrand&lt;/code&gt;
と指定すると
その後cuffcompareをかけたときのClass Codesが
cが3765
eが122
xが10668
とあまりにもxが多い結果となっています。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;--library-type fr-firststrand&lt;/code&gt;
で行ってみると
cが9739
eが6870
xが33
となります。&lt;/p&gt;
&lt;p&gt;この結果から本当に &lt;code&gt;--library-type fr-secondstrand&lt;/code&gt; をつかっていいものかと思っています。&lt;/p&gt;
&lt;p&gt;tophatのマニュアルにをよく読むと
&lt;code&gt;fr-firststrand&lt;/code&gt;はdUTP, NSR, NNSR
&lt;code&gt;fr-secondstrand&lt;/code&gt;    はLigation, Standard SOLiD
に適していると書かれています。&lt;/p&gt;
&lt;p&gt;私は一般的なRNA ligationを用いたstrand specificなRNA-Seqはfirst strandを
dUTPやNNSRはsecond strandをシーケンスすると思っていたのでが違うのでしょうか？
それともtophatのマニュアルがまちがえているのでしょうか。&lt;/p&gt;
&lt;p&gt;以上長文となってしまいましたが質問させていただければと思います。&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">snk_u</dc:creator><pubDate>Sat, 30 Apr 2011 02:16:26 +0900</pubDate><guid>http://qa.lifesciencedb.jp/questions/432/strand-specific-rna-seq%E3%83%87%E3%83%BC%E3%82%BF%E8%A7%A3%E6%9E%90%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8Btophat%E3%81%AE%E5%88%A9%E7%94%A8%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6</guid><category>solid</category><category>tophat</category><category>ngs</category></item></channel></rss>